In a large skillet cook the sliced onions, the garlic, and salt and pepper to taste in the oil over moderate heat, stirring, until the onions are golden around the edges, remove the skillet from the heat, and keep the mixture warm. In a kettle of boiling salted water cook the spaghetti until it is al dente, reserve 1/4 cup of the cooking water, and drain the spaghetti well. In a serving bowl whisk the goat cheese with the reserved cooking water until it is melted and the mixture is smooth, add the spaghetti, the onion mixture, the arugula, the walnuts, the grated cheese, the basil or parsley, and salt and pepper to taste, and toss the mixture well. Garnish the pasta with the diced onion.