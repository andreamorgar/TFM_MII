Preheat oven to 350 degrees F (175 degrees C). Prepare the elbow macaroni according to package directions. Meanwhile, melt the butter in a small saucepan over medium high heat. Stir in the flour until a cream colored paste forms. Then pour in the milk and stir constantly until this comes to a hard boil, then stir for 1 more minute. Remove from heat and set aside. When the macaroni is cooked, spread 1/2 of it into the bottom of a lightly greased 9x13-inch baking dish. Then layer 1/2 of the grated onion, 1/2 of the salt and pepper and 1/2 of each of the cheeses. Repeat this one more time: macaroni, onion, salt and pepper and cheeses, and then pour the reserved white sauce over all. Top off with small pats of butter to taste. Cover and bake at 350 degrees F (175 degrees C) for 45 minutes.