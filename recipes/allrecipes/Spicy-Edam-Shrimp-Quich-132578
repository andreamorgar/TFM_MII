Preheat oven to 350 degrees F (175 degrees C). Melt butter in a skillet over medium heat. Stir in the onion, and cook until softened and translucent, then stir in mushrooms. Cook for an additional 3 minutes. Pour in red wine, and simmer until the liquid has nearly evaporated. Whisk together eggs, sour cream, red pepper flakes, and salt until smooth; stir in cheese. Place shrimp into the pie shell in an even layer, sprinkle mushroom mixture over top, then pour in custard and spread evenly. Bake in preheated oven for 50 minutes until set. Allow to cool for 10 minutes before serving.