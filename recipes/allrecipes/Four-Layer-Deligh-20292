Preheat oven to 300 degrees F (150 degrees C). Coat a 9x13 inch baking dish with cooking spray. In a bowl, cream together margarine with 1/4 cup confectioners' sugar. Mix in flour and 1 cup pecans. Press into prepared dish. Bake in preheated oven 15 minutes, until very lightly browned. Cool completely. In a bowl, cream together cream cheese with remaining 1 cup confectioners' sugar. Fold in half the whipped topping. Spread over cooled crust. Stir together pudding mix and milk and allow to set up slightly. Spread over cream cheese layer. Top with remaining whipped topping and sprinkle with remaining nuts. Keep refrigerated.