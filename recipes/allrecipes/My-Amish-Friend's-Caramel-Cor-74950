Place the popped popcorn into two shallow greased baking pans. You may use roasting pans, jelly roll pans, or disposable roasting pans. Add the peanuts to the popped corn if using. Set aside. Preheat the oven to 250 degrees F (120 degrees C). Combine the brown sugar, corn syrup, margarine and salt in a saucepan. Bring to a boil over medium heat, stirring enough to blend. Once the mixture begins to boil, boil for 5 minutes while stirring constantly. Remove from the heat, and stir in the baking soda and vanilla. The mixture will be light and foamy. Immediately pour over the popcorn in the pans, and stir to coat. Don't worry too much at this point about getting all of the corn coated. Bake for 1 hour, removing the pans, and giving them each a good stir every 15 minutes. Line the counter top with waxed paper. Dump the corn out onto the waxed paper and separate the pieces. Allow to cool completely, then store in airtight containers or resealable bags.