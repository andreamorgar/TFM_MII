Preheat oven to 350 degrees F (175 degrees C). Grease a 9x13 inch baking pan. In a large bowl, stir together the white sugar and cocoa. Mix in the melted butter until well blended. Beat in the eggs one at a time, then stir in 2 teaspoons vanilla. Combine the flour, baking powder and salt; stir into the chocolate mixture. Fold in walnuts. Spread evenly into the prepared pan. Bake for 30 minutes in the preheated oven, until the cake starts to pull away from the sides of the pan. Remove from the oven and cover with an even layer of miniature marshmallows. Return to the oven for about 2 to 3 minutes longer. Remove from the oven and allow to cool in the pan. In a small saucepan over medium heat, combine brown sugar, water and unsweetened chocolate. Bring to a boil and boil for 3 minutes. Stir in 1 tablespoon butter and 1 teaspoon vanilla until well blended. Mix in the confectioners' sugar until smooth. Spread over the marshmallow layer. Allow frosting to set before cutting into bars.