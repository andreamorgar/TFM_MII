Bring a large pot of lightly salted water to a boil. Add spaghetti and cook for 8 to 10 minutes or until al dente; drain (or use leftover pasta; see Cook's Note). While pasta is cooking, melt butter in a saucepan over medium heat. Stir in onion; cook and stir until the onion has softened and turned translucent, about 5 minutes. Stir in cream of mushroom soup, 1/2 cup water, and shredded cheese. Heat mixture until cheese melts, stirring often. Mix in the ham, cooked and drained pasta, chopped pimento, and chopped parsley to saucepan; stir to combine. Cook until mixture is heated through, then serve.