In a large saucepan, mix together the sugar, cornstarch and 3 cups milk. If making chocolate, mix in cocoa powder. Bring to a boil and stir frequently until mixture thickens. Whisk together last cup of milk with egg yolks. As pudding thickens, add egg yolk mixture and stir frequently. Bring to a boil for 1 minute. Remove from heat, stir in butter and vanilla. Pour into baked pie shells or use as a pudding. Refrigerate until chilled.