Sift together and set aside in large bowl the flour and sugar. In saucepan over medium heat bring to a boil; 1/2 cup margarine or butter, 1/2 cup shortening, 1 cup water, and 4 tablespoons cocoa. Pour cocoa mixture over flour and sugar mixture. Stir in buttermilk, eggs, baking soda, and 1/2 teaspoon vanilla. Mix well and pour into a greased and floured sheet pan. Bake in a preheated 400 degrees F (205 degrees C) oven for 20 minutes. To Make Frosting: Five minutes before cake is done, bring to boil in a saucepan 1/2 cup margarine or butter, 6 tablespoons milk, and 4 tablespoons cocoa. Remove from heat and immediately stir in the confectioners' sugar, nuts (if desired), and 1/2 teaspoon vanilla extract. Beat until smooth and immediately pour frosting over cake. Cake may be served warm or at room temperature.