Preheat oven to 325 degrees F (165 degrees C). Butter or grease one 8x16 inch baking dish. Bring a large pot of salted water to a boil. Add potatoes and cook until tender but still firm, about 15 minutes. Drain and cool. Place bacon in a large, deep skillet. Cook over medium high heat until evenly brown. Add onions, mushrooms, salt and pepper. Cook until onions and mushrooms are soft. Slice potatoes and place a thin layer in the baking dish. Follow with a layer of the bacon mixture and repeat layers until all ingredients are used. Pour cream and milk over layers; sprinkle with grated cheese. Bake for approximately 35 minutes, or until cream and milk have almost reduced completely.