To make the green sauce, put the egg yolks, vinegar, mustard and sugar into the bowl of a mini food processor. (Don’t use a large processor as the sauce won’t combine properly. If you don’t have a food processor with a small bowl, you can use a stick blender or even whisk by hand.) Season to taste with salt and freshly ground black pepper.Pulse until well combined then, with the motor running, very gradually pour the oil in a very thin stream onto the eggs and blend until smooth and thick.Add the shallot, garlic, capers, all the herbs and lemon juice and blend again until they are finely chopped and the sauce is very green.Adjust the seasoning to taste and add one tablespoon of cold water. Blend for a few seconds more until the sauce has a soft, spoonable consistency, adding a little more water if necessary. Divide between four small serving bowls or ramekins and set aside until ready to serve.This next bit may seem a fiddle but is very easy and quick once you’ve got the hang of it. Take one of the herring fillets and place skin-side down on a board. Cut in half lengthways into two fillets. Take once of the fillets and run your fingers up and down over the flesh a few times to get an idea where any pin-bones are located. Cut the fillet lengthways in half again, either side of the pin-bones that you’ll find running through the top part of each fillet. Run your fingers up and down again to make sure you’ve got them all, using tweezers to pull out any stray bones. Repeat with the remaining fillets.Next, cut each fillet into 2-3 diagonal slices depending on size. Rinse the herring pieces under cold water and drain.Pour the oil into a medium saucepan or a deep-fat fryer and heat to 180C/350F, checking the temperature using a cooking thermometer. (CAUTION: Hot oil can be dangerous. Do not leave unattended.)While the oil is heating, put the flour, semolina, mustard powder, cayenne pepper and salt in a large bowl. Season with lots of freshly ground black pepper and mix well.When the oil is at the right temperature, dredge a quarter of the damp herring fillets in the seasoned flour (the fish shouldn’t be too dry or the flour won’t stick, so rinse in more water and drain again if necessary). Shake off the excess flour and lower the floured fish gently into the oil. Fry for 3-3½ minutes, or until the pieces are crisp and golden-brown. Stir once towards the end of the cooking time to separate the fish.Carefully remove the fried fish with a slotted spoon and place in a pile on a plate lined with kitchen paper. Keep an eye on the temperature as you fry, as the oil can begin to get hotter and will also cool quickly once the fish is added.Scoop out any bits of crispy fish that float to the top of the oil and bring back to 180C/350F. Repeat the coating and frying process with the remaining fish. Keep the cooked fish warm in a low oven between batches if you like.To serve, divide the hot fish between four plates or bowls and place the sauce to the side. Add the lemon wedges for squeezing.