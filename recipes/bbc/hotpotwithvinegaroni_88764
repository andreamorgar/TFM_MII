Heat the oven to 160C/320F/gas 3. Heat two tablespoons of the oil in a two litre (3 pints 10fl oz) flameproof casserole.Add the onions and garlic with a little fine salt, and fry until light golden-brown. Remove with a slotted spoon, place in a bowl and reserve.Add another two tablespoons of oil to the pan and fry the mushrooms until cooked through. Tip the cooked mushrooms into the bowl containing the onions.Chop the beef into large cubes and coat in the seasoned flour.Heat the remaining oil in the casserole and fry the beef, in two batches, until well browned all over. Remove from the pan and set aside.Pour in the wine and scrape the pan with a wooden spoon to loosen the browned bits. Simmer until it has a syrupy consistency, then add the stock, sauces, and herbs. Stir well and bring to a simmer.Return the onions, mushrooms, and beef to the pan, and add sea salt and freshly ground black pepper, to taste. Cover and place in the oven to braise for two hours, adding the potatoes after an hour.For the pastry, sift the flour and salt into a bowl. Rub in the butter, then slowly mix in 3-4 tablespoons of cold water to make a stiff dough, bringing the dough together to make a ball with your hands. Wrap the dough in cling film and refrigerate for at least an hour - remove the dough 15 minutes before using.For the vinegar onions, gently warm the vinegar in a pan, tip it into a large bowl and stir in the onions. Cover and set aside.Remove the casserole from the oven and rest for about 30 minutes. Increase the oven temperature to 200C/390F/gas 6. Roll out the pastry and, with a sharp knife, cut out a lid about 2.5cm/1in larger than the diameter of the casserole dish.Discard the herbs from the casserole, taste and adjust the seasoning if necessary.Brush water around the rim of the casserole dish. Place the pastry lid on top, sealing well to the edge, and brush all over with water. Pierce a hole in the centre.Return to the oven to cook for 20-30 minutes until the pastry is a deep golden-brown colour. Leave to rest in a warm place for 10 minutes.Serve the hotpot with the vinegar onions on the side.