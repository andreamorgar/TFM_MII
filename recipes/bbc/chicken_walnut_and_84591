Heat a large saucepan over a medium heat. Pour in the vegetable oil and fry the onions until translucent and lightly browned.Season the chicken on both sides with salt and freshly ground black pepper and add to the pan. Increase the temperature and stir well to ensure you seal the thighs on both sides. Once they are gently browned, turn off the heat and set aside.Heat another large saucepan over a medium high heat and toast the flour until it turns pale beige. Add the ground walnuts and cook the mixture through.Add 1.2 litres/2 pints of water to the pan, stir well and bring the mixture to a slow boil, then cover with a lid and cook for an hour over a low-medium heat. This will cook the walnuts and soften their texture; once you see the natural oils of the walnuts rise to the surface, the mixture is cooked.Add the sugar and pomegranate molasses and stir well for about a minute. Take care to stir the pomegranate molasses well as it will take a while to dissolve.Add the chicken and onions to the walnut and pomegranate mixture, cover and cook for about 2 hours, stirring thoroughly every 30 minutes to ensure the walnuts do not stick to the base of the pan.For the rice, bring a large saucepan of water to the boil. Add the rice and a generous pinch of salt. Boil for 6-8 minutes until the rice is par boiled. (The rice is par boiled when the rice is a brilliant white colour and the grains have begun to soften.) Drain the rice and rinse under cold running water for a couple of minutes.Line the bottom of the saucepan used to cooked the rice with non-stick baking paper. Return to the hob and pour in the oil, butter and a tablespoon of crushed sea salt. Scatter the rice in the saucepan. Do not overcrowd the rice, you want the lightness of the falling rice to allow the steam to rise up.Wrap the pan lid in a tea towel (to lock in the steam and make for a secure, tight seal). Make sure the tea towel is kept away from the flames.Cook the rice on a low heat for 45 minutes-1 hour. The grains should be puffed up when cooked. Flip the rice onto a serving plate, then scrape out the crispy tahdig (rice at the bottom of the pot) and place on top.Serve the chicken alongside the rice topped with pomegranate seeds.